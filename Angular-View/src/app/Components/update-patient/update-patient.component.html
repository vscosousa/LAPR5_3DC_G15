<div class="update-container">
  <app-sidebar></app-sidebar>
  <div class="screens-container">
    <div class="screen">
      <button routerLink="/manage-patients" type="button" class="btn btn-back">
        Go Back
      </button>
      <h2 class="update-title" style="text-align: center">Update Patient</h2>
      <div class="content-container">
        <form class="update-form" (submit)="updatePatientDetails($event)">
          <input
            type="text"
            placeholder="First Name"
            [(ngModel)]="existingPatient.firstName"
            name="firstName"
            required
          />
          <input
            type="text"
            placeholder="Last Name"
            [(ngModel)]="existingPatient.lastName"
            name="lastName"
            required
          />
          <input
            type="text"
            placeholder="Full Name"
            [(ngModel)]="existingPatient.fullName"
            name="fullName"
            required
          />
          <input
            type="email"
            placeholder="Email"
            [(ngModel)]="existingPatient.email"
            name="email"
            required
          />
          <input
            type="text"
            placeholder="Phone Number"
            [(ngModel)]="existingPatient.phoneNumber"
            name="phoneNumber"
            required
          />
          <input
            type="text"
            placeholder="Emergency Contact"
            [(ngModel)]="existingPatient.emergencyContact"
            name="emergencyContact"
            required
          />
          <button type="button" class="btn btn-select" (click)="openAllergiesModal()">Select Allergies</button>
          <button type="button" class="btn btn-select" (click)="openMedicalConditionsModal()">Select Medical Conditions</button>
          <!-- Buttons -->
          <button type="submit" class="btn btn-update">Update Patient</button>
          <button type="button" class="btn btn-clear" (click)="clearForm()">
            Clear Form
          </button>
        </form>
      </div>
    </div>
  </div>

  <!-- Allergies Modal -->
  <div class="modal" *ngIf="showAllergiesModal">
    <div class="modal-content">
      <span class="close" (click)="closeAllergiesModal()">&times;</span>
      <h2>Select Allergies</h2>
      <div class="multi-select-list">
        <div *ngFor="let allergy of allergies" class="multi-select-item">
          <span>{{ allergy.allergyName }}</span>
          <input
            type="checkbox"
            [checked]="isAllergySelected(allergy.id)"
            (change)="onAllergyChange($event, allergy.id)"
          />
        </div>
      </div>
      <button type="button" class="btn btn-save" (click)="closeAllergiesModal()">Save</button>
    </div>
  </div>

  <!-- Medical Conditions Modal -->
  <div class="modal" *ngIf="showMedicalConditionsModal">
    <div class="modal-content">
      <span class="close" (click)="closeMedicalConditionsModal()">&times;</span>
      <h2>Select Medical Conditions</h2>
      <div class="multi-select-list">
        <div *ngFor="let medicalCondition of medicalConditions" class="multi-select-item">
          <span>{{ medicalCondition.medicalConditionName }}</span>
          <input
            type="checkbox"
            [checked]="isMedicalConditionSelected(medicalCondition.id)"
            (change)="onMedicalConditionChange($event, medicalCondition.id)"
          />
        </div>
      </div>
      <button type="button" class="btn btn-save" (click)="closeMedicalConditionsModal()">Save</button>
    </div>
  </div>
</div>
